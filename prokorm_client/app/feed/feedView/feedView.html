<div class="feed-view">
  <div layout="row" class="feed-title">
    <h2 class="feed-name">{{feedView.feed.name}} 
      <b>{{feedView.feed.year}}</b>
      <div class="feed-composition">{{feedView.feed.composition}}</div>
    </h2>
    <!--<div class="weight-wrapper" ng-class="{opened: feedView.feed.general.opened.value}"> -->
      <span class="weight-control" ng-class="{opened: feedView.feed.opened}">
        <span class="balance">{{feedView.feed.balanceWeight}}</span>
        <span class="total">{{feedView.feed.totalWeight}}</span>
      </span>
    <!--</div>-->
    <div class="actions" flex>
      <!--<md-button class="md-raised" ng-click="feedView.copy()">
        Copy
      </md-button>-->
      <md-button class="md-raised" ng-click="feedView.diff()">
        Cравнить
      </md-button>
      <md-button class="md-raised" ng-click="feedView.edit()">
        Редактировать
      </md-button>
      <md-button class="md-warn" ng-click="feedView.delete($event)">
        Удалить
      </md-button>
    </div>
  </div>

  <!-- HEADER -->
  <div class="feed-view-header" layout="row">
    <div flex="{{block.width}}" ng-repeat="block in feedView.feedItemSections">
        <label class="title">
            {{block.label}}
        </label>
    </div>
  </div>  

  <!-- CONTENT -->
  <div class="feed-view-content" layout="row">
      <diV ng-switch="block.key" flex="{{block.width}}" ng-repeat="block in feedView.feedItemSections">

        <!-- ANALYSIS -->
        <ul ng-switch-when="analysis" class="feed-properties" ng-class="block.key">
          <li ng-switch="key" class="property" ng-repeat="(key, data) in block.controls" layout="row">
            <!-- LABEL -->
            <label flex ng-class="{catalogLink: data.catalogLink}" ng-href="data.catalogLink">
                <a ng-if="data.catalogLink" ng-href="{{data.catalogLink}}">{{data.label}}</a>
                <lable ng-if="!data.catalogLink">{{data.label}}</lable>
                <lable ng-if="data.dimension">, {{data.dimension}}</lable> 
            </label>

            
            <!-- DRY Control -->
            <md-checkbox ng-if="key === 'isNaturalWet'" ng-repeat="v in data.values track by $index" class="md-primary dry-switch" ng-model="block.controls.isNaturalWet.values[$index]">
                ({{ block.controls.isNaturalWet.values[$index] ? 'Да' : 'Нет' }})
            </md-checkbox> 

            <div class="value" ng-if="key !== 'isNaturalWet'" ng-repeat="v in data.values track by $index">
            {{ 
                (v.rawValue || v.dryValue) ?
                (block.controls.isNaturalWet.values[$index] ? v.rawValue : v.dryValue) :
                v 
            }}
            </div>
                           
          </li>
        </ul>  

        <!-- OTHER -->
        <ul ng-switch-default class="feed-properties" ng-class="block.key" >
          <li class="property" ng-repeat="(key, data) in block.controls" layout="row">
            <!-- LABEL -->
            <label flex>
                {{data.label}}  {{data.dimension}}
            </label>
            <!-- SINGLE VALUE -->
            <div class="value" ng-if="!data.values">{{data.value}}</div>
          </li>   
        </ul>
      </diV>
  </div> 
</div>